name: Daily AI Paper Digest

on:
  schedule:
    # âš ï¸ æ ¸å¿ƒä¿®æ”¹ï¼šåŒ—äº¬æ—¶é—´å‡Œæ™¨ 04:00 å¯åŠ¨
    # GitHub ä½¿ç”¨ UTC æ—¶é—´ï¼Œæ‰€ä»¥æ˜¯å‰ä¸€å¤©çš„ 20:00
    # 20:00 UTC + 8å°æ—¶ = 04:00 åŒ—äº¬æ—¶é—´
    - cron: '0 20 * * *'
  
  # å…è®¸æ‰‹åŠ¨è§¦å‘æµ‹è¯•
  workflow_dispatch:

jobs:
  build-and-run:
    runs-on: ubuntu-latest
    
    permissions:
      contents: read
      
    steps:
    - name: Check out repository code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run paper summarizer & Save output
      env:
        # ğŸ‘‡ å¿…é¡»æŠŠæ‰€æœ‰ Secrets æ˜¾å¼æ³¨å…¥ç¯å¢ƒå˜é‡ï¼ŒPython æ‰èƒ½è¯»å–ï¼
        GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
        ZHIPU_API_KEY: ${{ secrets.ZHIPU_API_KEY }}    # æ™ºè°± Key
        EMAIL_PASSWORD: ${{ secrets.EMAIL_PASSWORD }}   # é‚®ç®±åº”ç”¨å¯†ç 
      
      # è¿è¡Œè„šæœ¬ï¼Œæ ‡å‡†è¾“å‡ºä¿å­˜åˆ° report.md (ç”¨äº Artifact)ï¼ŒåŒæ—¶è„šæœ¬å†…éƒ¨ä¼šå‘é‚®ä»¶
      run: python main.py > report.md

    - name: Upload Daily Report
      # å³ä½¿å‘äº†é‚®ä»¶ï¼Œä¹Ÿä¸Šä¼ ä¸€ä»½åˆ° GitHub ä½œä¸ºå¤‡ä»½
      uses: actions/upload-artifact@v4
      with:
        name: Daily-Paper-Report
        path: report.md
        retention-days: 30
